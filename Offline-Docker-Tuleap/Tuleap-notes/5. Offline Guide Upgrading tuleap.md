					***Offline Guide: Upgrading Tuleap Community Edition in Docker***

################################################ Backup/Restore/Backup for Docker-Compose Deployment ############################################


# https://docs.tuleap.org/administration-guide/system-administration/backup.html#backup

✅ STEP-BY-STEP: BACKUP & UPGRADE TULEAP (Docker Community Edition)


🔹 1. Confirm Current Running Container
$ docker ps
#Identify the Tuleap container ID or name (e.g., tuleap_community_1).


🔹 2. Backup Tuleap
a) Backup Volumes

#Run these on the host machine (not inside the container):
$ cp -r /var/lib/docker/volumes/tuleap-setup_db-data/_data /backup/tuleap_db
$ cp -r /var/lib/docker/volumes/tuleap-setup_tuleap-data/_data /backup/tuleap_data

🔸 tuleap-setup_db-data: Stores the MySQL database.
🔸 tuleap-setup_tuleap-data: Stores Tuleap config, files, logs, etc.


#Enter the MySQL root password when prompted.


🔹 3. Stop & Remove Existing Containers

$ docker stop <container_id>
$ docker rm <container_id>
$ docker rmi <image_id>

#(You can also run docker-compose down if you're using Docker Compose.)


🔹 4. Pull New Tuleap Image (Online or Offline)


✅ If you have internet access:
docker pull tuleap/tuleap-community-edition:latest


✅ If you are offline, first pull on a machine with internet:
$ docker pull tuleap/tuleap-community-edition:latest
$ docker save tuleap/tuleap-community-edition:latest -o tuleap_latest.tar
$ docker load -i tuleap_latest.tar
$ docker images


🔹 5. Update docker-compose.yml (if needed)
#Make sure the image tag points to the latest version:

image: tuleap/tuleap-community-edition:latest


🔹 6. Recreate Tuleap Containers
$ docker-compose up -d

✅ This does not delete volumes, so your data (DB, config, attachments, etc.) will remain intact and be reused.


🔹 7. Verify Upgrade
$ docker exec -it <new_container_id_or_name> tuleap --version



⚠️ Notes
-- Volumes are preserved by Docker Compose unless you run docker volume rm.

-- To be safe, always do manual volume backup before an upgrade.

-- docker-compose down stops and removes containers and networks but keeps volumes intact.

-- docker-compose up -d recreates containers with the latest images and re-attaches existing volumes, preserving your data.







